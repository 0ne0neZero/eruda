(function(root,factory){if(typeof define==="function"&&define.amd){define([],factory)}else if(typeof module==="object"&&module.exports){module.exports=factory()}else{root._=factory()}})(this,function(){var _={};if(typeof window==="object"&&window._)_=window._;var isUndef=_.isUndef=function(){function exports(val){return val===void 0}return exports}();var inherits=_.inherits=function(){var objCreate=Object.create;function noop(){}function exports(Class,SuperClass){if(objCreate)return Class.prototype=objCreate(SuperClass.prototype);noop.prototype=SuperClass.prototype;Class.prototype=new noop}return exports}();var has=_.has=function(){var hasOwnProp=Object.prototype.hasOwnProperty;function exports(obj,key){return hasOwnProp.call(obj,key)}return exports}();var noop=_.noop=function(){function exports(){}return exports}();var isObj=_.isObj=function(){function exports(val){var type=typeof val;return!!val&&(type==="function"||type==="object")}return exports}();var allKeys=_.allKeys=function(){function exports(obj){var ret=[],key;for(key in obj)ret.push(key);return ret}return exports}();var idxOf=_.idxOf=function(){function exports(arr,val,fromIdx){return Array.prototype.indexOf.call(arr,val,fromIdx)}return exports}();var keys=_.keys=function(exports){exports=Object.keys||function(obj){var ret=[],key;for(key in obj){if(has(obj,key))ret.push(key)}return ret};return exports}({});var identity=_.identity=function(){function exports(val){return val}return exports}();var objToStr=_.objToStr=function(){var ObjToStr=Object.prototype.toString;function exports(val){return ObjToStr.call(val)}return exports}();var isArr=_.isArr=function(exports){exports=Array.isArray||function(val){return objToStr(val)==="[object Array]"};return exports}({});var isFn=_.isFn=function(){function exports(val){var objStr=objToStr(val);return objStr==="[object Function]"||objStr==="[object GeneratorFunction]"}return exports}();var isStr=_.isStr=function(){function exports(val){return objToStr(val)==="[object String]"}return exports}();var isNum=_.isNum=function(){function exports(val){return objToStr(val)==="[object Number]"}return exports}();var isArrLike=_.isArrLike=function(){var MAX_ARR_IDX=Math.pow(2,53)-1;function exports(val){if(!has(val,"length"))return false;var len=val.length;return isNum(len)&&len>=0&&len<=MAX_ARR_IDX&&!isFn(val)}return exports}();var each=_.each=function(){function exports(obj,iteratee,ctx){var i,len;if(isArrLike(obj)){for(i=0,len=obj.length;i<len;i++)iteratee.call(ctx,obj[i],i,obj)}else{var _keys=keys(obj);for(i=0,len=_keys.length;i<len;i++){iteratee.call(ctx,obj[_keys[i]],_keys[i],obj)}}return obj}return exports}();var createAssigner=_.createAssigner=function(){function exports(keysFn,defaults){return function(obj){each(arguments,function(src,idx){if(idx===0)return;var keys=keysFn(src);each(keys,function(key){if(!defaults||isUndef(obj[key]))obj[key]=src[key]})});return obj}}return exports}();var defaults=_.defaults=function(exports){exports=createAssigner(allKeys,true);return exports}({});var ajax=_.ajax=function(){function exports(options){defaults(options,exports.setting);var type=options.type,url=options.url,data=options.data,dataType=options.dataType,success=options.success,error=options.error,complete=options.complete,xhr=options.xhr();xhr.onreadystatechange=function(){if(xhr.readyState!==4)return;var result;var status=xhr.status;if(status>=200&&status<300||status===304){result=xhr.responseText;try{if(dataType==="json")result=JSON.parse(result)}catch(e){}success(result,xhr)}else{error(xhr)}complete(xhr)};if(type==="GET"){data=serialize(data);url+=url.indexOf("?")>-1?"&"+data:"?"+data}else{if(isObj(data))data=serialize(data)}xhr.open(type,url,true);xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");type==="GET"?xhr.send():xhr.send(data);return xhr}exports.setting={type:"GET",success:noop,error:noop,complete:noop,dataType:"json",data:{},xhr:function(){return new window.XMLHttpRequest},timeout:0};exports.get=function(){return exports(parseArgs.apply(null,arguments))};exports.post=function(){var options=parseArgs.apply(null,arguments);options.type="POST";return exports(options)};function parseArgs(url,data,success,dataType){if(isFn(data)){success=data;data={}}return{url:url,data:data,success:success,dataType:dataType}}function serialize(data){var ret=[];each(data,function(val,key){ret.push(key+"="+encodeURIComponent(val))});return ret.join("&")}return exports}();var extend=_.extend=function(exports){exports=createAssigner(allKeys);return exports}({});var extendOwn=_.extendOwn=function(exports){exports=createAssigner(keys);return exports}({});var values=_.values=function(){function exports(obj){var ret=[];each(obj,function(val){ret.push(val)});return ret}return exports}();var contain=_.contain=function(){function exports(arr,val){if(!isArrLike(arr))arr=values(arr);return idxOf(arr,val)>=0}return exports}();var isMatch=_.isMatch=function(){function exports(obj,src){var _keys=keys(src),len=_keys.length;if(obj==null)return!len;obj=Object(obj);for(var i=0;i<len;i++){var key=_keys[i];if(src[key]!==obj[key]||!(key in obj))return false}return true}return exports}();var loadJs=_.loadJs=function(){function exports(src,cb){var script=document.createElement("script");script.src=src;script.onload=function(){var isNotLoaded=script.readyState&&script.readyState!="complete"&&script.readyState!="loaded";cb&&cb(!isNotLoaded)};document.body.appendChild(script)}return exports}();var matcher=_.matcher=function(){function exports(attrs){attrs=extendOwn({},attrs);return function(obj){return isMatch(obj,attrs)}}return exports}();var now=_.now=function(exports){exports=Date.now||function(){return(new Date).getTime()};return exports}({});var optimizeCb=_.optimizeCb=function(){function exports(fn,ctx,argCount){if(isUndef(ctx))return fn;switch(argCount==null?3:argCount){case 1:return function(val){return fn.call(ctx,val)};case 3:return function(val,idx,collection){return fn.call(ctx,val,idx,collection)};case 4:return function(accumulator,val,idx,collection){return fn.call(ctx,accumulator,val,idx,collection)}}return function(){return fn.apply(ctx,arguments)}}return exports}();var safeCb=_.safeCb=function(exports){exports=function(val,ctx,argCount){if(val==null)return identity;if(isFn(val))return optimizeCb(val,ctx,argCount);if(isObj(val))return matcher(val);return function(key){return function(obj){return obj==null?undefined:obj[key]}}};return exports}({});var map=_.map=function(){function exports(obj,iteratee,ctx){iteratee=safeCb(iteratee,ctx);var _keys=!isArrLike(obj)&&keys(obj),len=(_keys||obj).length,results=Array(len);for(var i=0;i<len;i++){var curKey=_keys?_keys[i]:i;results[i]=iteratee(obj[curKey],curKey,obj)}return results}return exports}();var toArr=_.toArr=function(){function exports(val){if(!val)return[];if(isArr(val))return val;if(isArrLike(val)&&!isStr(val))return map(val);return[val]}return exports}();var Class=_.Class=function(){function exports(methods,statics){return Base.extend(methods,statics)}function makeClass(parent,methods,statics){statics=statics||{};var ctor=function(){var args=toArr(arguments);return this.initialize?this.initialize.apply(this,args)||this:this};inherits(ctor,parent);ctor.prototype.superclass=parent;ctor.extend=function(methods,statics){return makeClass(ctor,methods,statics)};ctor.inherits=function(Class){inherits(Class,ctor)};ctor.methods=function(methods){extend(ctor.prototype,methods);return ctor};ctor.statics=function(statics){extend(ctor,statics);return ctor};ctor.methods(methods).statics(statics);return ctor}var Base=exports.Base=makeClass(Object,{className:"Base",callSuper:function(parent,name,args){var superMethod=parent.prototype[name];if(!superMethod)return;return superMethod.apply(this,args)},toString:function(){return this.className}});return exports}();var Select=_.Select=function(exports){exports=Class({className:"Select",initialize:function(selector){this.length=0;if(!selector)return this;if(isStr(selector))return rootSelect.find(selector);if(selector.nodeType){this[0]=selector;this.length=1}},find:function(selector){var ret=new Select;this.each(function(){mergeArr(ret,this.querySelectorAll(selector))});return ret},each:function(fn){each(this,function(element,idx){fn.call(element,idx,element)});return this}});var rootSelect=new exports(document);function mergeArr(first,second){var len=second.length,i=first.length;for(var j=0;j<len;j++)first[i++]=second[j];first.length=i;return first}return exports}({});var $safeEls=_.$safeEls=function(){function exports(val){return toArr(isStr(val)?new Select(val):val)}return exports}();var delegate=_.delegate=function(exports){function retTrue(){return true}function retFalse(){return false}function trigger(e){var handlers=this.events[e.type],handler,handlerQueue=formatHandlers.call(this,e,handlers);e=new delegate.Event(e);var i=0,j,matched,ret;while((matched=handlerQueue[i++])&&!e.isPropagationStopped()){e.curTarget=matched.el;j=0;while((handler=matched.handlers[j++])&&!e.isImmediatePropagationStopped()){ret=handler.handler.apply(matched.el,[e]);if(ret===false){e.preventDefault();e.stopPropagation()}}}}function formatHandlers(e,handlers){var current=e.target,ret=[],delegateCount=handlers.delegateCount,selector,matches,handler,i;if(current.nodeType){for(;current!==this;current=current.parentNode||this){matches=[];for(i=0;i<delegateCount;i++){handler=handlers[i];selector=handler.selector+" ";if(matches[selector]===undefined){matches[selector]=contain(this.querySelectorAll(selector),current)}if(matches[selector])matches.push(handler)}if(matches.length)ret.push({el:current,handlers:matches})}}if(delegateCount<handlers.length){ret.push({el:this,handlers:handlers.slice(delegateCount)})}return ret}exports={add:function(el,type,selector,fn){var handler={selector:selector,handler:fn},handlers;if(!el.events)el.events={};if(!(handlers=el.events[type])){handlers=el.events[type]=[];handlers.delegateCount=0;el.addEventListener(type,function(e){trigger.apply(el,arguments)},false)}selector?handlers.splice(handlers.delegateCount++,0,handler):handlers.push(handler)},remove:function(el,type,selector,fn){var events=el.events;if(!events||!events[type])return;var handlers=events[type],i=handlers.length,handler;while(i--){handler=handlers[i];if((!selector||handler.selector==selector)&&handler.handler==fn){handlers.splice(i,1);if(handler.selector){handlers.delegateCount--}}}},Event:Class({className:"Event",initialize:function Event(e){this.origEvent=e},isDefaultPrevented:retFalse,isPropagationStopped:retFalse,isImmediatePropagationStopped:retFalse,preventDefault:function(){var e=this.origEvent;this.isDefaultPrevented=retTrue;if(e&&e.preventDefault)e.preventDefault()},stopPropagation:function(){var e=this.origEvent;this.isPropagationStopped=retTrue;if(e&&e.stopPropagation)e.stopPropagation()},stopImmediatePropagation:function(){var e=this.origEvent;this.isImmediatePropagationStopped=retTrue;if(e&&e.stopImmediatePropagation)e.stopImmediatePropagation();this.stopPropagation()}})};return exports}({});var $event=_.$event=function(exports){exports={on:eventFactory("add"),off:eventFactory("remove")};function eventFactory(type){return function(nodes,event,selector,handler){nodes=$safeEls(nodes);if(isUndef(handler)){handler=selector;selector=undefined}each(nodes,function(node){delegate[type](node,event,selector,handler)})}}return exports}({});var raf=_.raf=function(exports){var raf=window.requestAnimationFrame,cancel=window.cancelAnimationFrame;var lastTime=0,vendors=["ms","moz","webkit","o"];for(var i=0,len=vendors.length;i<len&&!raf;i++){raf=window[vendors[i]+"RequestAnimationFrame"];cancel=window[vendors[i]+"CancelAnimationFrame"]||window[vendors[i]+"CancelRequestAnimationFrame"]}raf=raf||function(cb){var curTime=now();var timeToCall=Math.max(0,16-(curTime-lastTime)),id=setTimeout(function(){cb(curTime+timeToCall)},timeToCall);lastTime=curTime+timeToCall;return id};cancel=cancel||function(id){clearTimeout(id)};raf.cancel=cancel;exports=raf;return exports}({});return _});